# 本地存储方式

## cookies

1. 每个域名存储量大致为 4K；
2. 个数有限制（每个浏览器不同）；
3. 携带在 http 请求头上；
4. 数据有效期：设置的有效期（服务端设置）内有效，不管窗口或者浏览器是否关闭。

```js
document.cookie = "cookieData = 'cookie test data'" // cookie设置数据
document.cookie // 获取所有数据，所有的cookie通过一个分号+空格的形式串联起来。
```

cookie 的操作，读写封装

```js
;(function() {
  var cookieObj = {
    //修改或是添加cookie
    add: function(name, value, hours) {
      var expire = ''
      if (hours != null) {
        expire = new Date(new Date().getTime() + hours * 3600000)
        expire = '; expires=' + expire.toGMTString()
      }
      document.cookie = name + '=' + escape(value) + expire + ';path=/'
      //如果指定域名可以使用如下
      //document.cookie = name + "=" + escape(value) + expire + ";path=/;domain=findme.wang";
    },
    //读取cookie
    get: function(c_name) {
      if (document.cookie.length > 0) {
        c_start = document.cookie.indexOf(c_name + '=')
        if (c_start != -1) {
          c_start = c_start + c_name.length + 1
          c_end = document.cookie.indexOf(';', c_start)
          if (c_end == -1) {
            c_end = document.cookie.length
          }
          return unescape(document.cookie.substring(c_start, c_end))
        }
      }
      return ''
    }
  }

  window.cookieObj = cookieObj
})()
```

### cookie 除了 key 与 value 还有哪些参数

1. max-age(可选)，max-age 用秒来设置 cookie 的生存期。
2. path (可选)
   例如 '/', '/mydir'。 如果没有定义，默认为当前文档位置的路径。(string or null)。路径必须为绝对路径（参见 RFC 2965）。关于如何在这个参数使用相对路径的方法请参见这段。
3. domain (可选)
   例如 'example.com'， '.example.com' (包括所有子域名), 'subdomain.example.com'。如果没有定义，默认为当前文档位置的路径的域名部分 (string 或 null)。

## localStorage

1. 存储量 5M
2. 永久存储，浏览器关闭后数据不丢失除非主动删除数据

```js
// 主要使用方法
localStorage.setItem('localData', 'localStorage test data') // localStorage 设置数据
let localData = localStorage.getItem('localData') // localStorage 取出数据
```

## sessionStorage

1. 存储量 5M
2. 仅在当前浏览器窗口关闭前有效（也就是说只要这个浏览器窗口没有关闭，即使刷新页面或进入同源另一页面，数据仍然存在。关闭窗口后，sessionStorage 即被销毁

```js
// 主要使用方法
sessionStorage.setItem('sessionData', 'sessionStorage test data') // sessionStorage 设置数据
let sessionData = sessionStorage.getItem('sessionData') // sessionStorage 取出数据
```

## 三者之间的区别

1. cookies 数据始终在同源的 http 请求中携带（即使不需要），而 sessionStorage 和 localStorage 不会自动把数据发给服务器，仅在本地保存；
2. 存储数据量大小不同
3. 数据有效期不同

## 调用 localStorage、cookies 等本地存储方式可以实现多个标签页之间的通信（但是受到同源政策的限制）
