# 闭包

闭包是指有权访问另一个函数作用域中变量的函数，创建闭包的最常见的方式是在一个函数内创建另一个函数，另一个函数访问这个函数的局部变量，并返回出去。

闭包通常用来创建内部变量，使得这些变量不能被外部随意修改，同时又可以通过指定的函数接口来操作。

## 为什么函数可以构成闭包？

闭包就是一个具有封闭与包裹功能的结构，是为了实现具有私有访问空间的函数的。函数可以构成闭包。函数内部定义的数据函数外部无法访问，即函数具有封闭性；函数可以封装代码即具有包裹性，所以函数可以构成闭包。

## 闭包有什么用（特性）

闭包的作用，就是保存自己私有的变量，通过提供的接口(方法)给外部使用，但外部不能直接访问该变量。

当我们需要在模块中定义一些变量，并希望这些变量一直保存在内存中但又不会“污染”全局的变量时，就可以用闭包来定义这个模块。

闭包的缺点：闭包的缺点就是常驻内存，会增大内存使用量，使用不当很容易造成内存泄露。

函数套函数就是闭包吗？：不是！，当一个内部函数被其外部函数之外的变量引用时，才会形成了一个闭包。

## 闭包的基本模型

### 对象模式

函数内部定义个一个对象，对象中绑定多个函数（方法），返回对象，利用对象的方法访问函数内的数据

```js
function createPerson() {
  var __name__ = ''
  return {
    getName: function() {
      return __name__
    },
    setName: function(value) {
      __name__ = value
    }
  }
}
var p = createPerson()
p.set_Name('测试')
console.log(p.get_Name())
p.set_Name('测试1')
console.log(p.get_Name())
```

### 函数模式

函数内部定义一个新函数，返回新函数，用新函数获得函数内的数据

```js
function foo() {
  var num = Math.random()
  function func() {
    return mun
  }
  return func
}
var f = foo()
var res1 = f()
var res2 = f()
```

### 沙箱模式

沙箱模式就是一个自调用函数，代码写到函数中一样会执行，但是不会与外界有任何的影响，比如 jQuery

```js
(function () {
   var jQuery = function () { // 所有的算法 }
   // .... // .... jQuery.each = function () {}
   window.jQuery = window.$ = jQuery;
})();
```
