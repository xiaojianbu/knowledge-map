# 高阶组件

对简单的组件的封装，和父组件解耦

```html
<script src="https://cdn.jsdelivr.net/npm/vue@2.5.21/dist/vue.js"></script>
<div id="app">
  <smart-avatar username="vuejs" id="hello">
    <div slot="foo">
      这是一个具名插槽
    </div>
  </smart-avatar>
</div>
<script>
  // mock API
  function fetchURL(username, cb) {
    setTimeout(() => {
      cb('https://avatars3.githubusercontent.com/u/6128107?v=4&s=200')
    }, 500)
  }
  const Avatar = {
    props: ['src'],
    template: `<img :src="src" />`
  }
  // 高阶组件withAvatarUrl
  function withAvatarUrl(innerComponent, fetchURL) {
    return {
      props: ['username'],
      data() {
        return {
          url: `http://via.placeholder.com/200*200`
        }
      },
      created() {
        fetchURL(this.username, url => {
          this.url = url
        })
      },
      render(h) {
        // console.log(this.$slots.default);
        // console.log(this.$slots.foo);
        return h(
          innerComponent,
          {
            props: {
              src: this.url,
              attrs: this.$attrs
            }
          },
          this.$slots.default
        )
      }
    }
  }
  const SmartAvatar = withAvatarUrl(Avatar, fetchURL)
  new Vue({
    el: '#app',
    components: { SmartAvatar }
  })
</script>
```

[探索 Vue 高阶组件](http://hcysun.me/2018/01/05/%E6%8E%A2%E7%B4%A2Vue%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6/)
